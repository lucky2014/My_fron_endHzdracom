define("alinw/pagination/2.0.11/pagination",["$","alinw/select/2.0.0/select","arale/select/0.9.7/select","arale/overlay/1.1.1/overlay","arale/position/1.0.1/position","arale/iframe-shim/1.0.2/iframe-shim","arale/widget/1.1.1/widget","arale/base/1.1.1/base","arale/class/1.1.0/class","arale/events/1.1.0/events","arale/templatable/0.9.1/templatable","gallery/handlebars/1.0.2/handlebars","gallery/handlebars/1.0.2/runtime"],function(a,b,c){var d=a("$"),e=a("alinw/select/2.0.0/select"),f=function(a,b){var c={size:10,page:1,redirectUrl:"#page/",wrap:'<div class="kuma-pagination"><ul class="fd-clr"></ul></div>',type:"common",sizeList:[10,20,50],showQuickTrigger:!0,showSizeList:!0,showOnePage:!0,showTotalNum:!0,quickTriggerLabel:'<div class="jump-to-page">去第<input class="jump-to-page-input" type="text" class="ui-input" maxlength="6"/>页<a class="J_confirmJumpTo kuma-button kuma-button-swhite">确定</a>',sizeListPerPageLabel:"条/页",totalNumLabel:'<div class="total-count">共<span class="total-count-num"></span>条</div>'};this.element=a,this.options=d.extend({},c,b),this.init()};d.extend(f.prototype,{constructor:f,init:function(){this.$el=d(this.element),this.pageSize=10,this.ec=d({});var a=this.$container=d(this.options.wrap);this.$wrap=a.find("ul"),this.$el.html(a),this.render(),this.initEvents()},trigger:function(){this.ec.trigger.apply(this.ec,arguments)},on:function(){this.ec.on.apply(this.ec,arguments)},render:function(){var a=this;if(this.options.showQuickTrigger&&"common"===this.options.type){var b=d(this.options.quickTriggerLabel);b.insertAfter(a.$wrap).on("click",".J_confirmJumpTo",function(){var c=b.find(".jump-to-page-input"),e=+c.val();/^[0-9]*$/.test(e)&&(a.page=e>a.maxPage?a.maxPage:a.page=1>e?1:e,a.setPaging({total:a.total,page:a.page,size:a.pageSize}),a.trigger("pagination:goto",a.page),a.options.onPageChanged&&d.isFunction(a.options.onPageChanged)&&a.options.onPageChanged.call(a,a.page),c.val(""))})}if(this.options.showSizeList){for(var c="",f=0;f<this.options.sizeList.length;f++){var g=this.options.sizeList[f];c+='<option value="'+g+'">'+g+"</option>"}var h=d('<select class="size-per-page">'+c+"</select>"+'<span class="kuma-page-size-label">'+this.options.sizeListPerPageLabel+"</span>");h.insertAfter(this.$wrap),a.$container.find("select").each(function(){var b=a.showSizeSelector=new e({trigger:this}).on("change",function(b){var c=d(b).data("value");a.$el.data("pagesize",c),a.pageSize=c,a.setPaging({total:a.total,page:1,size:c}),a.trigger("pagination:goto",1),a.options.onPageChanged&&d.isFunction(a.options.onPageChanged)&&a.options.onPageChanged.call(a,1)});switch(b.element.addClass("kuma-pagination-select"),a.options.type){case"table":b.element.addClass("kuma-pagination-table-select");break;case"tiny":b.element.addClass("kuma-pagination-tiny-select");break;case"common":b.element.addClass("kuma-pagination-common-select")}})}if(this.options.showTotalNum){var i=d(this.options.totalNumLabel);i.insertAfter(this.$wrap)}switch(this.options.type){case"table":this.$container.addClass("kuma-pagination-table"),this.$wrap.addClass("table-cell");break;case"tiny":this.$container.addClass("kuma-pagination-tiny"),this.$wrap.addClass("tiny-cell");var h=d('<span class="tiny-current-num"></span>/<span class="tiny-total-num"></span>');h.insertBefore(this.$wrap);break;case"common":this.$container.addClass("kuma-pagination-common"),this.$wrap.addClass("common-cell")}},initEvents:function(){this.$wrap.on("click","li:not(.disabled)",d.proxy(this.onPagingClicked,this)),this.on("page_updated",d.proxy(this.refreshPaging,this))},refreshPaging:function(){var a,b,c,e,f=this.page-1>0?this.page-1:1,g=this.page+1<this.maxPage?this.page+1:this.maxPage;if(this.$wrap.find("li").off("**"),this.$wrap.empty(),c=this.options.redirectUrl?d('<li class="prev" data-index="prev"><a href="'+this.options.redirectUrl+f+'" title="prev" class="kuma-icon kuma-icon-chevron-left"></a></li>').appendTo(this.$wrap):d('<li class="prev" data-index="prev"><a href="javascript:;" title="prev" class="kuma-icon kuma-icon-chevron-left"></a></li>').appendTo(this.$wrap),1==this.page&&c.addClass("disabled"),this.maxPage>=1&&"tiny"!==this.options.type&&(this.options.redirectUrl?this.$wrap.append(d('<li data-index="1"><a href="'+this.options.redirectUrl+1+'">1</a></li>')):this.$wrap.append(d('<li data-index="1"><a href="javascript:;">1</a></li>'))),this.maxPage>1&&"tiny"!==this.options.type){for(a=this.page-2>2?this.page-2:2,b=this.page+2<this.maxPage?this.page+2:this.maxPage-1,this.page-2>2&&this.$wrap.append(d('<li class="disabled no-page"><a href="javascript:;" style="border:0 none;">…</a></li>')),a;b>=a;a++)this.options.redirectUrl?d('<li data-index="'+a+'"><a href="'+this.options.redirectUrl+a+'">'+a+"</a></li>").appendTo(this.$wrap):d('<li data-index="'+a+'"><a href="'+"javascript:;"+'">'+a+"</a></li>").appendTo(this.$wrap);this.page+3<this.maxPage&&this.$wrap.append(d('<li class="disabled no-page"><a href="javascript:;" >…</a></li>')),this.options.redirectUrl?this.$wrap.append(d('<li data-index="'+this.maxPage+'"><a href="'+this.options.redirectUrl+this.maxPage+'">'+this.maxPage+"</a></li>")):this.$wrap.append(d('<li data-index="'+this.maxPage+'"><a href="javascript:;">'+this.maxPage+"</a></li>"))}this.$container.find(".total-count-num").text(this.total),"tiny"===this.options.type&&(this.$container.find(".tiny-total-num").text(this.maxPage),this.$container.find(".tiny-current-num").text(this.page)),e=this.options.redirectUrl?d('<li class="next" data-index="next"><a class="kuma-icon kuma-icon-chevron-right" href="'+this.options.redirectUrl+g+'" title="next"></a></li>').appendTo(this.$wrap):d('<li class="next" data-index="next"><a class="kuma-icon kuma-icon-chevron-right" href="javascript:;" title="next"></a></li>').appendTo(this.$wrap),this.page==this.maxPage&&e.addClass("disabled"),this.$wrap.find("li[data-index="+this.page+"]").addClass("active"),this.$wrap.find("li").addClass("fd-clr")},onPagingClicked:function(a){var b=this,c=d(a.currentTarget),e=c.data("index"),f=1;if(!c.hasClass("active")){switch(this.$wrap.find("li").removeClass("active"),c.addClass("active"),e){case"prev":f=b.page-1<1?1:b.page-1;break;case"next":f=b.page+1>b.maxPage?b.maxPage:b.page+1;break;case"first":f=1;break;case"last":f=b.maxPage;break;default:f=e}this.trigger("pagination:goto",this.page),this.options.onPageChanged&&d.isFunction(this.options.onPageChanged)&&this.options.onPageChanged.call(b,f)}},setPaging:function(a){this.total=a.total,this.page=a.page,this.pageSize=a.size?a.size:this.options.size,this.maxPage=Math.ceil(this.total/this.pageSize),this.trigger("page_updated"),this.options.showOnePage||("table"==this.options.type?this.total<10?this.$container.hide():this.$container.show():this.maxPage<=1?this.$container.hide():this.$container.show());var b=this;return b.options.showSizeList&&d.each(b.options.sizeList,function(a,c){b.pageSize==c&&b.showSizeSelector.set("selectedIndex",a)}),this},destroy:function(){this.$container.remove(),this.hasOwnProperty("element")&&delete this.element,this.hasOwnProperty("$el")&&delete this.$el,this.hasOwnProperty("$container")&&delete this.$container,this.hasOwnProperty("$wrap")&&delete this.$wrap,this.hasOwnProperty("ec")&&delete this.ec,this.options.showSizeList&&this.showSizeSelector.destroy(),this.hasOwnProperty("options")&&delete this.options}}),c.exports=f});
